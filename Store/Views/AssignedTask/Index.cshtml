@model Store.Models.Stores.AssignedWorkorderViewModel
    @{
        ViewBag.Title = "مدیریت کارهای روتین ";
    }
<div class="row bg-title">
    <div class="col-lg-3 col-md-4 col-12">
        <h4 class="page-title">مدیریت کارهای روتین</h4>
    </div>
    <div class="col-lg-9 col-md-8 col-12">
       
        <ol class="breadcrumb">
            <li><a href="/Home/Index">داشبورد</a></li>
            <li class="active"> اختصاص وظایف </li>
        </ol>
    </div>
    <!-- /.col-lg-12 -->
</div>
    

    <div class="row" id="scrolltoinside">
        <div class="col-md-12">
            <div class="white-box">

                <section class="m-t-40">
                    <div class="sttabs tabs-style-iconbox">
                        <nav>
                            <ul>
                                <li class="tab-current"><a href="#section-workOrder" class="sticon ti-home"><span>لیست  دستور کار</span></a></li>
                                <li><a href="#section-routine" class="sticon ti-gift"><span>لیست روتین</span></a></li>

                            </ul>
                        </nav>
                        <div class="content-wrap">
                            <section id="section-workOrder" class="content-current">
                                <div class="table-responsive white-box">
                                    <div id="example_wrapper" class="dataTables_wrapper">

                                        <table id="WorkOrderGrid" class="table table-striped table-condensed table-bordered no-margin">
                                            <thead>
                                                <tr>

                                                    <th>عملیات</th>
                                                    <th>عنوان دستور کار</th>
                                                    <th>متراژ محاسبه شده توسط کارشناس</th>
                                                    <th>وضعیت </th>
                                                    <th>تاریخ شروع دستور کار</th>
                                                    <th>تاریخ پایان دستور کار</th>
                                                    <th>کاربر ایجاد کننده</th>
                                                    <th>تاریخ ایجاد </th>

                                                </tr>
                                            </thead>

                                        </table>
                                    </div>
                                </div>
                                

                            </section>

                            <section id="section-routine">
                                <div class="panel-group" id="exampleAccordionDefault" aria-multiselectable="true" role="tablist">
                                    <div class="panel">
                                        <div class="panel-heading" id="exampleHeadingDefaultOne" role="tab">
                                            <h4 class="panel-title"> <a class="font-bold collapsed" data-toggle="collapse" href="#exampleCollapseDefaultOne" data-parent="#exampleAccordionDefault" aria-expanded="false" aria-controls="exampleCollapseDefaultOne"><i class="zmdi zmdi-search zmdi-hc-fw" style="font-size:20px!important;"></i> جستجو پیشرفته </a> </h4>
                                        </div>
                                        <div class="panel-collapse collapse" id="exampleCollapseDefaultOne" aria-labelledby="exampleHeadingDefaultOne" role="tabpanel" aria-expanded="false" style="height: 0px;">
                                            <div class="panel-body">@{Html.RenderAction("FilterRoutin", "AssignedTask");}</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="table-responsive white-box">
                                    <div id="example_wrapper" class="dataTables_wrapper">

                                        <table id="RoutineGrid" class="table table-striped table-condensed table-bordered no-margin" style="width:100% !important;">
                                            <thead>
                                                <tr>

                                                    <th>عملیات</th>
                                                    <th>عنوان </th>
                                                    <th>تاریخ فعالیت</th>
                                                    <th>کاربر ایجاد کننده</th>
                                                    <th>تاریخ ایجاد </th>


                                                </tr>
                                            </thead>

                                        </table>
                                    </div>
                                </div>
                            </section>

                        </div>
                        <!-- /content -->
                    </div>
                    <!-- /tabs -->
                </section>

            </div>

        </div>
    </div>

   
  
    <script>

        $(document).ready(function () {

            var table = $("#WorkOrderGrid").DataTable({
                "language": {
                    "sEmptyTable": "هیچ داده ای در جدول وجود ندارد",
                    "sInfo": "نمایش _START_ تا _END_ از _TOTAL_ رکورد",
                    "sInfoEmpty": "نمایش 0 تا 0 از 0 رکورد",
                    "sInfoFiltered": "(فیلتر شده از _MAX_ رکورد)",
                    "sInfoPostFix": "",
                    "sInfoThousands": ",",
                    "sLengthMenu": "نمایش _MENU_ رکورد",
                    "sLoadingRecords": "در حال بارگزاری...",
                    "sProcessing": "در حال پردازش...",
                    "sSearch": "جستجو:",
                    "sZeroRecords": "رکوردی با این مشخصات پیدا نشد",
                    "oPaginate": {
                        "sFirst": "ابتدا",
                        "sLast": "انتها",
                        "sNext": "بعدی",
                        "sPrevious": "قبلی"
                    },
                    "oAria": {
                        "sSortAscending": ": فعال سازی نمایش به صورت صعودی",
                        "sSortDescending": ": فعال سازی نمایش به صورت نزولی"
                    }
                },
                "processing": true,
                "serverSide": true,
                "info": true,
                "searching": true,

                "stateSave": false,
                "lenghtMenu": [[10, 20, 50, -1], [10, 20, 50, "All"]],
                "responsive": true,
                //dom: '<"html5buttons"B>lTfgitp',
                //buttons: [

                //    { extend: 'excel', title: 'ExampleFile' },
                //    {extend: 'pdf', title: 'ExampleFile'},

                //    {extend: 'print',
                //        customize: function (win){
                //            $(win.document.body).addClass('white-bg');
                //            $(win.document.body).css('font-size', '10px');

                //            $(win.document.body).find('table')
                //                    .addClass('compact')
                //                    .css('font-size', 'inherit');
                //        }
                //    }
                //],
                "ajax": {
                    "url": "/AssignedTask/WorkOrderList",
                    "type": "get",

                },
                "columns": [

                    { "data": "Id", "orderable": false },

                    { "data": "WorkTitle", "orderable": false },

                    { "data": "RealArea", "orderable": false },
                    
                    { "data": "StatusName", "orderable": false },

                    { "data": "ShamsiDate", "orderable": false },

                    { "data": "ShamsiEndDate", "orderable": false },

                    { "data": "ActionUserName", "orderable": false },

                    { "data": "ShamsiCreateDate", "orderable": false }



                ],
                "columnDefs": [

                    {
                        targets: 0,
                        render: function (data, type, row, meta) {
                            return '<div class="button-box"><div class="btn-group m-l-10"><button aria-expanded="false" data-toggle="dropdown" class="btn btn-danger dropdown-toggle waves-effect waves-light" type="button" > عملیات &nbsp; &nbsp; <span class="caret"></span></button><ul role="menu" class="dropdown-menu animated flipInX"><li><a href="javascript:void()" onclick="EditFunction(\'' + "/AssignedTask/Edit" + '\',' + data + ');" class="btn btn-info waves-effect btn-rounded waves-light"> <i class="zmdi zmdi-edit  zmdi-hc-fw"></i> ویرایش   </a></li><li class="divider"></li><li><a href="/WorkorderDetail/Index/' + data + '" class="btn btn-success waves-effect btn-rounded waves-light" target="_blank"> <i class="zmdi zmdi-info zmdi-hc-fw"></i> مشاهده تاریخچه دستور کار  </a></li><li class="divider"></li><li><a href="javascript:void();" class="btn btn-youtube waves-effect btn-rounded waves-light" onclick="Remove(' + data + ')"> <i class="zmdi zmdi-delete zmdi-hc-fw"></i> حذف</a></li></ul></div>'
                        }

                    },
                ],

                "order": []
            });

            var tableRoutine = $("#RoutineGrid").DataTable({
                "language": {
                    "sEmptyTable": "هیچ داده ای در جدول وجود ندارد",
                    "sInfo": "نمایش _START_ تا _END_ از _TOTAL_ رکورد",
                    "sInfoEmpty": "نمایش 0 تا 0 از 0 رکورد",
                    "sInfoFiltered": "(فیلتر شده از _MAX_ رکورد)",
                    "sInfoPostFix": "",
                    "sInfoThousands": ",",
                    "sLengthMenu": "نمایش _MENU_ رکورد",
                    "sLoadingRecords": "در حال بارگزاری...",
                    "sProcessing": "در حال پردازش...",
                    "sSearch": "جستجو:",
                    "sZeroRecords": "رکوردی با این مشخصات پیدا نشد",
                    "oPaginate": {
                        "sFirst": "ابتدا",
                        "sLast": "انتها",
                        "sNext": "بعدی",
                        "sPrevious": "قبلی"
                    },
                    "oAria": {
                        "sSortAscending": ": فعال سازی نمایش به صورت صعودی",
                        "sSortDescending": ": فعال سازی نمایش به صورت نزولی"
                    }
                },
                "processing": true,
                "serverSide": true,
                "info": true,
                "searching": true,

                "stateSave": false,
                "lenghtMenu": [[10, 20, 50, -1], [10, 20, 50, "All"]],
                "responsive": true,
                //dom: '<"html5buttons"B>lTfgitp',
                //buttons: [

                //    { extend: 'excel', title: 'ExampleFile' },
                //    {extend: 'pdf', title: 'ExampleFile'},

                //    {extend: 'print',
                //        customize: function (win){
                //            $(win.document.body).addClass('white-bg');
                //            $(win.document.body).css('font-size', '10px');

                //            $(win.document.body).find('table')
                //                    .addClass('compact')
                //                    .css('font-size', 'inherit');
                //        }
                //    }
                //],
                "ajax": {
                    "url": "/AssignedTask/RoutinList",
                    "type": "get",

                },
                "columns": [

                    { "data": "Id", "orderable": false },

                    { "data": "RoutineTitle", "orderable": false },

                    { "data": "ShamsiDate", "orderable": false },

                    { "data": "ActionUserName", "orderable": false },

                    { "data": "ShamsiCreateDate", "orderable": false },



                ],
                "columnDefs": [

                    {
                        targets: 0,
                        render: function (data, type, row, meta) {
                            return '<div class="button-box"><div class="btn-group m-l-10"><button aria-expanded="false" data-toggle="dropdown" class="btn btn-danger dropdown-toggle waves-effect waves-light" type="button" > عملیات &nbsp; &nbsp; <span class="caret"></span></button><ul role="menu" class="dropdown-menu animated flipInX"><li><a href="javascript:void()" class="btn btn-info waves-effect btn-rounded waves-light"  onclick="EditFunction(\'' + "/AssignedTask/EditRoutin" + '\',' + data + ');"> <i class="zmdi zmdi-edit zmdi-hc-fw"></i> ویرایش  </a></li><li class="divider"></li><li><a href="javascript:void();" class="btn btn-dribbble waves-effect waves-light btn-rounded" onclick="EditFunction(\'' + "/AssignedTask/AssignedTaskPersonnel" + '\',' + data + ');"><i class="zmdi zmdi-accounts zmdi-hc-fw"></i> لیست پرسنل</a></li><li class="divider"></li><li><a href="javascript:void();" class="btn btn-youtube waves-effect btn-rounded waves-light" onclick="Remove(' + data + ')"> <i class="zmdi zmdi-delete zmdi-hc-fw"></i> حذف</a></li></ul></div>'
                        }


                    },
                ],

                "order": []
            });


        });

        function Remove(id) {
            swal({
                title: "رکورد حذف شود؟",
                text: " درصورت حذف شما نمیتوانید این رکورد را بازیابی کنید!",
                type: "warning",
                showCancelButton: true,
                confirmButtonColor: "#1ab394",
                confirmButtonText: "بله",
                cancelButtonText: "خیر",
                closeOnConfirm: false,
                closeOnCancel: false
            },
                function (isConfirm) {

                    if (isConfirm) {
                        $.ajax({
                            url: '/Company/Delete',
                            data: { id: id },
                            type: 'Post',

                            dataType: "json",
                            success: function (data) {
                                if (data.ResultType == 0) {
                                    swal("حذف شد!", data.Message, "success");
                                    $('#CompanyGrid').DataTable().ajax.reload();
                                }
                                else if (data.ResultType == 1) {

                                    swal("خطا", "امکان حذف رکورد وجود ندارد!", "error");
                                }
                                else if (data.ResultType == 2) {

                                    swal("فاقد مجوز دسترسی", data.Message, "error");
                                }


                            }


                        });

                    } else {
                        swal("کنسل", "حذف کنسل شد :)", "error");
                    }
                });

        };


    </script>